var System={functions:{},register:function(t,e,o){System.functions[t]={requires:e,cb:o}},active:function(){$.each(System.functions,function(t,o){t=o.cb(function(t,e){o[t]=e},{id:t});$.each(t.setters,function(t,e){e(System.functions[o.requires[t]])}),t.execute()})}};System.register("libs/edit",[],function(e,t){"use strict";t&&t.id;return{setters:[],execute:function(){function t(){this.token="pk.eyJ1Ijoic3JkcmFrYSIsImEiOiJja2FlZHBmYXUwMHpoMnJudHJnazZsOWY1In0.tAAoQbjhJKq_DdwpTTimrw",this.toolbarOptions=[["bold","italic","underline","strike"],["blockquote","code-block"]],this.cke(),this.mapEdit(),this.mapEditPoint(),this.mapMarkers(),this.addFeature()}t.prototype.cke=function(){var t=$(".cke");t.length&&t.each(function(t,e){ClassicEditor.create(e).then(function(t){t.model.document.on("change:data",function(){$(e).val(t.getData())})}).catch(function(t){console.error(t)})})},t.prototype.mapEdit=function(){var t;$("#map-edit").length&&(t=$("#center").val().split(","),this._mapEdit({latitude:t[1]||4.646876,longitude:t[0]||-74.087547}))},t.prototype._mapEdit=function(t){var e=$("#points").val()?JSON.parse($("#points").val()):"";mapboxgl.accessToken=this.token;var t=new mapboxgl.Map({container:"map-edit",style:"mapbox://styles/mapbox/streets-v9",center:[t.longitude,t.latitude],zoom:10.5}),n=new MapboxDraw({displayControlsDefault:!1,controls:{polygon:!0,trash:!0}});t.addControl(new mapboxgl.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0})),t.addControl(n,"top-left"),t.on("load",function(){var t;e&&(t={type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:e}},n.add(t))}),t.on("draw.modechange",function(t){var e,o,a=n.getAll();$("#points").val(JSON.stringify(a.features[0].geometry.coordinates)),"draw_polygon"===n.getMode()&&(e=[],o=a.features[a.features.length-1].id,a.features.forEach(function(t){"Polygon"===t.geometry.type&&t.id!==o&&e.push(t.id)}),n.delete(e))}),t.on("draw.update",function(t){var e=n.getAll();$("#points").val(JSON.stringify(e.features[0].geometry.coordinates))})},t.prototype.mapEditPoint=function(){var t;$("#map-edit-point").length&&(t=$("#point").val().split(","),this._mapEditPoint({latitude:t[1]||4.646876,longitude:t[0]||-74.087547}))},t.prototype._mapEditPoint=function(t){var e=L.map("map-edit-point").setView([t.latitude,t.longitude],13);L.control.locate({initialZoomLevel:15,locateOptions:{enableHighAccuracy:!0,maxZoom:15},strings:{title:"Localizar mi posición"}}).addTo(e),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(e);var o=L.marker([t.latitude,t.longitude],{draggable:!0}).addTo(e);o.on("dragend",function(){$("#point").val(o.getLatLng().lng+","+o.getLatLng().lat)}),e.on("locationfound",function(t){o.setLatLng(t.latlng).bindPopup("Mueva el marcador si es necesario").openPopup()})},t.prototype.mapMarkers=function(){if($("#map-markers").length)try{var t=JSON.parse($("#markers").val());this._mapMarkers(t)}catch(t){this._mapMarkers([])}},t.prototype._mapMarkers=function(t){var e=($("#center").val()||",").split(","),o=L.map("map-markers").setView([e[1]||4.646876,e[0]||-74.087547],11);L.control.locate({initialZoomLevel:15,locateOptions:{enableHighAccuracy:!0,maxZoom:15},strings:{title:"Localizar mi posición"}}).addTo(o),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(o),t.forEach(function(t){L.marker([t[1],t[0]]).addTo(o)})},t.prototype.addFeature=function(){var t=$(".list-features");t.length&&t.each(function(t,e){function o(){var o="";n.forEach(function(t,e){o+='<div class="form-group flex">',o+='<div class="form-control">',o+='<input type="text" id="i_'+e+'" class="input" placeholder=" " name="features['+e+'][name]" value="'+t.name+'" data-index="'+e+'" data-name="name">',o+='<label for="i_'+e+'">Nombre</label>',o+="</div>",o+='<div class="form-control pl-1">',o+='<input type="text" id="v_'+e+'" class="input" placeholder=" " name="features['+e+'][value]" value="'+t.value+'" data-index="'+e+'" data-name="value">',o+='<label for="v_'+e+'">Valor</label>',o+="</div>",o+="</div>"}),a.html(o),a.find("input").each(function(t,e){var o=$(e);o.on("input",function(){n[o.data("index")][o.data("name")]=o.val()})})}var a=$(e),n=a.data("features");o(),$(a.data("btn")).on("click",function(){n.push({name:"",value:"",slug:""}),o()})})},e("Edit",t)}}}),System.register("libs/util",[],function(e,t){"use strict";t&&t.id;return{setters:[],execute:function(){function t(){this.count()}t.prototype.count=function(){var a=this;$("[data-count]").each(function(t,e){var o=$(e);a._color(o),o.on("input",function(){a._color(o)})})},t.prototype._color=function(t){var e=t.val().length,o=$(t.data("target"));e>parseInt(t.data("count"),10)?o.parent().addClass("t-error"):o.parent().removeClass("t-error"),o.html(""+e)},e("Util",t)}}}),System.register("admin",["./libs/define","libs/edit","libs/util"],function(t,e){"use strict";var o,a;e&&e.id;return{setters:[function(t){},function(t){o=t},function(t){a=t}],execute:function(){new o.Edit,new a.Util}}}),System.active();