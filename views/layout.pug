mixin multimedia(name, image, cssClass)
  if (image)
    img.lazy(data-src=image alt=name class=cssClass?cssClass:'w-100')
  else
    img.lazy(data-src=`${appCnf.url.cdn}images/imagen_no_disponible.svg` alt=_.truncate(name, {'length': 30,'separator': ' '}) class=cssClass?cssClass:'w-100')

mixin img(name, image, size = ['196x196_jpg', '392x392_jpg'], cssClass)
  .relative.rd-0-5.oh
    if (image)
      img.lazy(data-src=image[size[0]] data-retina=image[size[1]] alt=_.truncate(name, {'length': 30,'separator': ' '}) class=cssClass?cssClass:'w-100')
    else
      img.lazy(data-src=`${appCnf.url.cdn}images/imagen_no_disponible.svg` alt='' class=cssClass?cssClass:'.w-100')
    .absolute.top.black.op-0-05.w-100.h-100

mixin simpleProduct(product)
  .h-100.white-sm.white-md.white-lg.white-xl.p-1-sm.p-1-md.p-1-lg.p-1-xl.sh-hover-sm.sh-hover-md.sh-hover-lg.sh-hover-xl.rd-0-2.oh
    .h-100.relative.mb-0-5
      a.mb-1(href=`/tiendas/${_.get(product, 'storeID.slug')}/productos/${product.sku}`)
        +img(product.name, _.first(product.imagesSizes), ['196x196_jpg', '392x392_jpg'])
      .w-100.mt-1-sm.mt-1-md.mt-1-lg.mt-1-xl
        a.mb-1(href=`/tiendas/${_.get(product, 'storeID.slug')}/productos/${product.sku}` title=product.name)
          .small.oh.ellipsis.lines-2.mb-0-5
            | #{product.name}
        if _.get(product, 'offer.percentage') && ( (_.get(product, 'offer.available.start') && moment().isAfter(moment(product.offer.available.start)) ) || !_.get(product, 'offer.available.start') )  && ( (_.get(product, 'offer.available.end') && moment().isBefore(moment(product.offer.available.end)) ) || !_.get(product, 'offer.available.end') )
          .b.t.t-gray-2 #{formatMoney(product.price || 0)}
          .b #{formatMoney(product.offer.price || 0)}
        else
          .b #{formatMoney(product.price || 0)}



mixin emptyCart
  .row.cart-empty.start-hide
    .col-md-12
      .oh.white.br-1.rd-0-2.mh-2
        .p-1.tc
          .bigx2
            i.fas.fa-shopping-cart
          h2 Tu carrito está vacío.
          p Antes de proceder al pago, debe agregar algunos productos a su carrito de compras.
          p Encontrará muchos productos interesantes en nuestra página.
          a.btn.btn--primary(href='/') Inicio

mixin btnPayment(order)
  if order.status === 'created' && order.payment.pse
    if order.payment.slug == 'wompi'
      button.btn.btn--alert.small.w-100.ph-0-5.rd-50.mt-0-5-sm.mt-0-5-xs.mb-1.payment--wompi(
        style="height: auto;"
        id='id_'+order.orderID
        data-order=order._id)
          b Wompi
          .title Pagar #{formatMoney(order.order.total)}
    else
      button.btn.btn--alert.small.w-100.ph-0-5.rd-50.mt-0-5-sm.mt-0-5-xs.mb-1.payment--file(
        style="height: auto;"
        data-id=order._id
        data-orderid=order.orderID
        data-payment=JSON.stringify(_.pick(order.payment,['fields','info']))
        )
          b #{_.get(_.find(payments,{slug:order.payment.slug}),'name')}
          .title Pagar #{formatMoney(order.order.total)}
  if order.status === 'picking' && !order.payment.pse
    button.btn.btn--alert.small.w-100.ph-0-5.rd-50.mt-0-5-sm.mt-0-5-xs.mb-1(
      style="height: auto;"
    )
      b Pago contra entrega
      .title Pagar #{formatMoney(order.order.total)}


doctype html
html(lang='es')
  head
    include fragments/head.pug
    include fragments/metatag.pug

  body(data-url-api=appCnf.url.api)
    if process.env.NODE_ENV == 'production' && appCnf.gtm
      noscript
        iframe(src='https://www.googletagmanager.com/ns.html?id='+appCnf.gtm height='0' width='0' style='display:none;visibility:hidden')

    include fragments/header
    .navbar-fixed-t
      block content

    .navbar-fixed-b-xs
      include fragments/footer.pug
    include fragments/scripts.pug