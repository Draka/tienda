var System={functions:{},register:function(t,e,n){System.functions[t]={requires:e,cb:n}},active:function(){$.each(System.functions,function(t,n){t=n.cb(function(t,e){n[t]=e},{id:t});$.each(t.setters,function(t,e){e(System.functions[n.requires[t]])}),t.execute()})}};System.register("libs/edit",[],function(e,t){"use strict";t&&t.id;return{setters:[],execute:function(){function t(){this.token="pk.eyJ1Ijoic3JkcmFrYSIsImEiOiJja2FlZHBmYXUwMHpoMnJudHJnazZsOWY1In0.tAAoQbjhJKq_DdwpTTimrw",this.toolbarOptions=[["bold","italic","underline","strike"],["blockquote","code-block"]],this.cke(),this.mapEdit(),this.mapEditPoint(),this.mapMarkers(),this.addFeature()}t.prototype.cke=function(){var t=$(".cke");t.length&&t.each(function(t,e){ClassicEditor.create(e).then(function(t){t.model.document.on("change:data",function(){$(e).val(t.getData())})}).catch(function(t){console.error(t)})})},t.prototype.mapEdit=function(){var t;$("#map-edit").length&&(t=($("#center").val()||",").split(","),this._mapEdit({latitude:t[1]||4.646876,longitude:t[0]||-74.087547}))},t.prototype._mapEdit=function(t){var e=[t.latitude,t.longitude],n=L.map("map-edit").setView(e,13);L.control.locate({initialZoomLevel:15,locateOptions:{enableHighAccuracy:!0,maxZoom:15},strings:{title:"Localizar mi posición"}}).addTo(n),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(n);var a=[];try{a=JSON.parse($("#points").val())}catch(t){a=[]}a.length&&(t={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[a.map(function(t){return[t.lng,t.lat]})]}}]},(e=L.geoJson(null,{pmIgnore:!1})).addTo(n),e.addData(t),e.on("pm:edit",function(t){t=t.layer._latlngs[0];$("#points").val(JSON.stringify(t))}),e.on("pm:dragend",function(t){t=t.layer._latlngs[0];$("#points").val(JSON.stringify(t))}),e.on("pm:remove",function(){$("#points").val("[]")})),n.pm.addControls({position:"topleft",drawMarker:!1,drawCircleMarker:!1,drawRectangle:!1,drawPolyline:!1,drawCircle:!1,cutPolygon:!1}),n.on("pm:drawstart",function(){var t=n.pm.getGeomanDrawLayers();$.each(t,function(t,e){e.remove()})}),n.on("pm:create",function(t){var e=t.layer._latlngs[0];$("#points").val(JSON.stringify(e)),t.layer.on("pm:ediit",function(t){t=t.layer._latlngs[0];$("#points").val(JSON.stringify(t))}),t.layer.on("pm:dragend",function(t){t=t.layer._latlngs[0];$("#points").val(JSON.stringify(t))}),t.layer.on("pm:remove",function(){$("#points").val("[]")})})},t.prototype.mapEditPoint=function(){var t;$("#map-edit-point").length&&(t=$("#point").val().split(","),this._mapEditPoint({latitude:t[1]||4.646876,longitude:t[0]||-74.087547}))},t.prototype._mapEditPoint=function(t){var e=L.map("map-edit-point").setView([t.latitude,t.longitude],13);L.control.locate({initialZoomLevel:15,locateOptions:{enableHighAccuracy:!0,maxZoom:15},strings:{title:"Localizar mi posición"}}).addTo(e),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(e);var n=L.marker([t.latitude,t.longitude],{draggable:!0}).addTo(e);n.on("dragend",function(){$("#point").val(n.getLatLng().lng+","+n.getLatLng().lat)}),e.on("locationfound",function(t){$("#point").val(n.getLatLng().lng+","+n.getLatLng().lat),n.setLatLng(t.latlng).bindPopup("Mueva el marcador si es necesario").openPopup()})},t.prototype.mapMarkers=function(){if($("#map-markers").length)try{var t=JSON.parse($("#markers").val());this._mapMarkers(t)}catch(t){this._mapMarkers([])}},t.prototype._mapMarkers=function(t){var e=($("#center").val()||",").split(","),n=L.map("map-markers").setView([e[1]||4.646876,e[0]||-74.087547],11);L.control.locate({initialZoomLevel:15,locateOptions:{enableHighAccuracy:!0,maxZoom:15},strings:{title:"Localizar mi posición"}}).addTo(n),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(n),t.forEach(function(t){L.marker([t[1],t[0]]).addTo(n)})},t.prototype.addFeature=function(){var t=$(".list-features");t.length&&t.each(function(t,e){function n(){var n="";o.forEach(function(t,e){n+='<div class="form-group flex">',n+='<div class="form-control">',n+='<input type="text" id="i_'+e+'" class="input" placeholder=" " name="features['+e+'][name]" value="'+t.name+'" data-index="'+e+'" data-name="name">',n+='<label for="i_'+e+'">Nombre</label>',n+="</div>",n+='<div class="form-control pl-1">',n+='<input type="text" id="v_'+e+'" class="input" placeholder=" " name="features['+e+'][value]" value="'+t.value+'" data-index="'+e+'" data-name="value">',n+='<label for="v_'+e+'">Valor</label>',n+="</div>",n+="</div>"}),a.html(n),a.find("input").each(function(t,e){var n=$(e);n.on("input",function(){o[n.data("index")][n.data("name")]=n.val()})})}var a=$(e),o=a.data("features");n(),$(a.data("btn")).on("click",function(){o.push({name:"",value:"",slug:""}),n()})})},e("Edit",t)}}}),System.register("libs/util",[],function(e,t){"use strict";t&&t.id;return{setters:[],execute:function(){function t(){this.count()}t.prototype.count=function(){var a=this;$("[data-count]").each(function(t,e){var n=$(e);a._color(n),n.on("input",function(){a._color(n)})})},t.prototype._color=function(t){var e=t.val().length,n=$(t.data("target"));e>parseInt(t.data("count"),10)?n.parent().addClass("t-error"):n.parent().removeClass("t-error"),n.html(""+e)},e("Util",t)}}}),System.register("admin",["./libs/define","libs/edit","libs/util"],function(t,e){"use strict";var n,a;e&&e.id;return{setters:[function(t){},function(t){n=t},function(t){a=t}],execute:function(){new n.Edit,new a.Util}}}),System.active();